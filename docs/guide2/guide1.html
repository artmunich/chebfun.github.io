<!DOCTYPE html>
<html>
  <head>
    <title>Chebfun2 Guide 1: Getting Started &raquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <!-- Bootstrap -->
    <link href="/css/bootstrap-custom.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/site.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/syntax.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/flexslider.css" rel="stylesheet"><!--  media="screen" -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<!-- ********* BEGIN GOOGLE ANALYTICS *********** -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4297200-9");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- ********* END GOOGLE ANALYTICS *********** -->  </head>

  <body>

    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!-- <a class="navbar-brand" href="/">Chebfun</a> -->
          <a id="logo" href="/"><img src='/images/logo.png' /></a>
        </div>
        <div class="navbar-collapse collapse">

          <!--<ul class="nav navbar-nav navbar-left"></ul>-->

          <ul class="nav navbar-nav navbar-right">
            <li><a href="/about/">About</a></li>
            <li><a href="/download/">Download</a></li>
            <li class="active"><a href="/docs/">Documentation</a></li>
            <li><a href="/examples/">Examples</a></li>
            <li><a href="/develop/">Develop</a></li>
            <li><a href="/citing/">Citing</a></li>
            <li><a href="/support/">Support</a></li>
          </ul>

        </div><!--/.nav-collapse -->
      </div>
    </div>


<div class='jumbotron page-header'>
    <div class='container'>
        <div class="row">
            <div class="col-md-12">
 
                <h1>Chebfun2 Guide 1: Getting Started</h1>
                <h2>A. Townsend, March 2013, last updated May 2014</h2>
            </div>
        </div>
    </div>
</div>

<div class="container">

    <ol class="breadcrumb">
       <li><a href="/">Home</a></li>
       <li><a href="/docs/">Documentation</a></li>
       <li><a href="/docs/guide2/">The Chebfun2 Guide</a></li>
       <li class="active">Chebfun2 Guide 1: Getting Started</li>
    </ol>

    <div class="row">

<!--
        <div class="col-md-4" role="navigation"> 
 
            <div id="sidebar" class="sidebar">
                <div class="">
                    <!- <a href="#"><strong>Chebfun2 Guide 1: Getting Started</strong></a> ->
                    <div class="toc">
<ul>
<li><a href="#11-what-is-a-chebfun2">1.1  What is a chebfun2?</a></li>
<li><a href="#12-what-is-a-chebfun2v">1.2 What is a chebfun2v?</a></li>
<li><a href="#13-constructing-chebfun2-objects">1.3 Constructing chebfun2 objects</a></li>
<li><a href="#14-basic-operations">1.4 Basic operations</a></li>
<li><a href="#15-chebfun2-methods">1.5 Chebfun2 methods</a></li>
<li><a href="#16-object-composition">1.6 Object composition</a></li>
<li><a href="#17-what-to-do-now">1.7 What to do now</a></li>
<li><a href="#18-references">1.8 References</a></li>
</ul>
</div>

                    <hr/>
                </div>
            </div>
        </div>
-->

        <div class="content">
            <div class="col-md-12" data-spy="scroll" data-target="#sidenav" role="main">
                <h2 id="11-what-is-a-chebfun2">1.1  What is a chebfun2?</h2>
<p>A chebfun2 is a function of two variables defined on a rectangle $[a,b]\times[c,d]$. The syntax for chebfun2 objects is similar to the syntax for matrices in Matlab, and Chebfun2 objects have many Matlab commands overloaded. For instance, <code>trace(f)</code> returns the sum of the diagonal entries when $f$ is a matrix and the integral of $f(x,x)$ when $f$ is a chebfun2.</p>
<p>Chebfun2 builds on Chebfun's univariate representations and algorithms. It is the first extension of Chebfun to functions of two variables.  Algorithmic details are given in [Townsend &amp; Trefethen 2013b].</p>
<p>The implementation of Chebfun2 exploits the observation that many functions of two variables can be well approximated by low rank approximants. A rank $1$ function is of the form $u(y)v(x)$, and a rank $k$ function can be written as the sum of $k$ rank $1$ functions. Smooth functions tend to be well approximated by functions of low rank. Chebfun2 determines low rank function approximations automatically by means of an algorithm that can be viewed as an iterative application of Gaussian elimination with complete pivoting [Townsend &amp; Trefethen 2013].</p>
<p>The underlying function representations are related to work by Carvajal, Chapman and Geddes [Carvajal, Chapman, &amp; Geddes 2008] and others including Bebendorf [Bebendorf 2008], Hackbusch, Khoromskij, Oseledets, and Tyrtyshnikov.</p>
<h2 id="12-what-is-a-chebfun2v">1.2 What is a chebfun2v?</h2>
<p>Chebfun2 can represent scalar valued functions, such as $\exp(x+y)$, and vector valued functions, such as $[\exp(x+y);\cos(x-y)]$.  We represent vector valued functions as chebfun2v objects, and these are useful for computations of vector calculus. For information about chebfun2v objects and vector calculus, see Chapters 5 and 6 of this guide.</p>
<h2 id="13-constructing-chebfun2-objects">1.3 Constructing chebfun2 objects</h2>
<p>A chebfun2 is constructed by supplying the Chebfun2 constructor with a function handle or string. The default rectangular domain of a chebfun2 is $[-1,1]\times [-1,1]$. (An example showing how to specify a different domain is given at the end of this chapter.) For example, here we make a chebfun2 representing $\cos(xy)$ on $[-1,1]\times[-1,1]$ and then plot it.</p>
<pre class="mcode-input">f = chebfun2(@(x,y) cos(x.*y));
plot(f), zlim([-2 2])</pre>

<p><img src="img/guide1_01.png" class="figure" alt=""></p>
<p>There are several commands for plotting a chebfun2, including <code>plot</code>, <code>contour</code>, <code>surf</code>, and <code>mesh</code>.  Here is a contour plot of $f$:</p>
<pre class="mcode-input">contour(f), axis square</pre>

<p><img src="img/guide1_02.png" class="figure" alt=""></p>
<p>One way to find the rank of the approximant used to represent $f$ is the following:</p>
<pre class="mcode-input">length(f)</pre>

<pre class="mcode-output">ans =
     6
</pre>

<p>Alternatively, more information can be given by displaying the chebfun2 object:</p>
<pre class="mcode-input">f</pre>

<pre class="mcode-output">f = 
chebfun2 object: (1 smooth surface)
       domain                 rank       corner values
[  -1,   1] x [  -1,   1]        6     [0.54 0.54 0.54 0.54]
vertical scale =   1 
</pre>

<p>The corner values are the values of the chebfun2 at $(-1,-1)$, $(-1,1)$, $(1,-1)$, and $(1,1)$, in that order. The vertical scale is used by operations to aim for close to machine precision relative to that number.</p>
<h2 id="14-basic-operations">1.4 Basic operations</h2>
<p>Once we have a chebfun2, we can compute quantities such as its definite double integral:</p>
<pre class="mcode-input">sum2(f)</pre>

<pre class="mcode-output">ans =
   3.784332281468732
</pre>

<p>This matches well the exact answer obtained by calculus:</p>
<pre class="mcode-input">exact = 3.784332281468732</pre>

<pre class="mcode-output">exact =
   3.784332281468732
</pre>

<p>We can also evaluate a chebfun2 at a point $(x,y)$, or along a line. When evaluating along a line a chebfun is returned because the answer is a function of one variable.</p>
<p>Evaluation at a point:</p>
<pre class="mcode-input">x = 2*rand - 1; y = 2*rand - 1;
f(x,y)</pre>

<pre class="mcode-output">ans =
   0.652014593874431
</pre>

<p>Evaluation along the line $y = \pi/6$:</p>
<pre class="mcode-input">f(:,pi/6)</pre>

<pre class="mcode-output">ans = 
   chebfun row (1 smooth piece)
       interval       length   endpoint values  
[      -1,       1]       13      0.87     0.87 
Epslevel = 7.797936e-15.  Vscale = 1.
</pre>

<p>There are plenty of other questions that may be of interest.  For instance, what are the zero contours of $f(x,y) - .95$?</p>
<p>r = roots(f-.95); plot(r), axis square, title('Zero contours of f-.95')</p>
<p>What is the partial derivative $\partial f/\partial y$?</p>
<pre class="mcode-input">fy = diff(f,1,1);
plot(fy)</pre>

<p><img src="img/guide1_03.png" class="figure" alt=""></p>
<p>The syntax for the <code>diff</code> command can cause confusion because we are following the matrix syntax in Matlab. We also offer <code>diffx(f,k)</code> and <code>diffy(f,k)</code> which differentiate $f(x,y)$ $k$ times with respect to the first first and second variable, respectively.</p>
<p>What is the mean value of $f(x,y)$ on $[-1,1]\times[-1,1]$?</p>
<pre class="mcode-input">mean2(f)</pre>

<pre class="mcode-output">ans =
   0.946083070367183
</pre>

<h2 id="15-chebfun2-methods">1.5 Chebfun2 methods</h2>
<p>There are over 100 methods that can be applied to chebfun2 objects. For a complete list type:</p>
<pre class="mcode-input">methods chebfun2</pre>

<pre class="mcode-output">
Methods for class chebfun2:

SmallExamples         gradient              qr                    
abs                   horzcat               quad2d                
cdr                   imag                  quiver                
chebfun2              integral              quiver3               
chebpoly2             integral2             rank                  
chebpolyplot          isempty               rdivide               
chebpolyplot2         isequal               real                  
chebpolyval2          isreal                restrict              
chol                  iszero                roots                 
complex               jacobian              simplify              
conj                  lap                   sin                   
constructor           laplacian             singleSignTest        
contour               ldivide               sinh                  
contourf              length                size                  
cos                   log                   sph2cart              
cosh                  lu                    sphere                
ctranspose            max                   sqrt                  
cumprod               max2                  squeeze               
cumsum                mean                  std                   
cumsum2               mean2                 std2                  
dblquad               median                subsref               
del2                  min                   sum                   
diag                  min2                  sum2                  
diff                  minandmax2            surf                  
diffx                 minus                 surface               
diffy                 mldivide              surfacearea           
discriminant          mrdivide              svd                   
display               mtimes                tan                   
domainCheck           norm                  tand                  
ellipsoid             normalizePivots       tanh                  
exp                   normalizeRowsAndCols  times                 
feval                 pivotplot             trace                 
fevalm                pivots                transpose             
flipdim               plot                  uminus                
fliplr                plus                  uplus                 
flipud                pol2cart              vertcat               
fred                  potential             volt                  
get                   power                 waterfall             
grad                  prod                  

Static methods:

chebpts2              outerProduct          
coeffs2vals           vals2coeffs           

</pre>

<p>Most of these commands have been overloaded from Matlab. More information about a Chebfun2 command can be found with <code>help</code>; for instance</p>
<pre class="mcode-input">help chebfun2/max2</pre>

<pre class="mcode-output"> MAX2   Global maximum of a CHEBFUN2.
    Y = MAX2(F) returns the global maximum of F over its domain.

    [Y, X] = MAX2(F) returns the global maximum in Y and its location X.  

    For certain problems this problem can be slow if the MATLAB Optimization
    Toolbox is not available.

  See also MIN2, MINANDMAX2.

</pre>

<h2 id="16-object-composition">1.6 Object composition</h2>
<p>So far, in this chapter, chebfun2 objects have been constructed explicitly via a command of the form <code>chebfun2(...)</code>. Another way to construct new chebfun2 objects is by composing them together with operations such as '+', '-', '.*', and '.^'. For instance,</p>
<pre class="mcode-input">x = chebfun2(@(x,y) x, [-2 3 -4 4]);
y = chebfun2(@(x,y) y, [-2 3 -4 4]);

f = 1./( 2 + cos(.25 + x.^2.*y + y.^2) );
contour(f), axis square</pre>

<p><img src="img/guide1_04.png" class="figure" alt=""></p>
<h2 id="17-what-to-do-now">1.7 What to do now</h2>
<p>To find out more about Chebfun2 you can continue reading this guide, or have a look at the Chebfun2 Examples. This guide and the Chebfun2 Examples are written as publishable m-files. For example, you can publish this chapter of the guide by typing publish('guide1.m').</p>
<h2 id="18-references">1.8 References</h2>
<p>[Bebendorf 2008] M. Bebendorf, <em>Hierarchical Matrices: A Means to Efficiently Solve Elliptic Boundary Value Problems</em>, Springer, 2008.</p>
<p>[Carvajal, Chapman, &amp; Geddes 2008] O. A. Carvajal, F. W. Chapman and K. O. Geddes, Hybrid symbolic-numeric integration in multiple dimensions via tensor-product series, <em>Proceedings of ISSAC'05</em>, M. Kauers, ed., ACM Press, 2005, pp.84-91.</p>
<p>[Townsend &amp; Trefethen 2013] A. Townsend and L. N. Trefethen, Gaussian elimination as an iterative algorithm, <em>SIAM News</em>, March 2013.</p>
<p>[Townsend &amp; Trefethen 2013b] A. Townsend and L. N. Trefethen, An extension of Chebfun to two dimensions, <em>SIAM Journal on Scientific Computing</em>, 35 (2013), C495-C518.</p>
            </div>
        </div>

    </div>
    

</div> 


    <div class="footer">
        <div style="margin: 5px">
        </div>
        <p>&copy; Copyright 2014 the University of Oxford and the Chebfun Developers.</p>
    </div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/js/config.js"></script>
    <script type="text/javascript" src="/js/jquery.flexslider-min.js"></script>

  </body>
</html>