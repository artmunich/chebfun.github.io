<!DOCTYPE html>
<html>
  <head>
    <title>Complex roots near the real axis &laquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <!-- Bootstrap -->
    <link href="/css/bootstrap-noprint.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/site.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/syntax.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <!-- <link href="/css/published.css" rel="stylesheet" media="screen"> -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<!-- ********* BEGIN GOOGLE ANALYTICS *********** -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4297200-9");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- ********* END GOOGLE ANALYTICS *********** -->  </head>

  <body>

    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Chebfun</a>
        </div>
        <div class="navbar-collapse collapse">

          <!--<ul class="nav navbar-nav navbar-left"></ul>-->

          <ul class="nav navbar-nav navbar-right">
            <li><a href="/about/">About</a></li>
            <li><a href="/download/">Download</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li class="active"><a href="/examples/">Examples</a></li>
            <li><a href="/develop/">Develop</a></li>
            <li><a href="/citing/">Citing</a></li>
            <li><a href="/support/">Support</a></li>
          </ul>

        </div><!--/.nav-collapse -->
      </div>
    </div>


<div class="container">

    <ol class="breadcrumb">
       <li><a href="/">Home</a></li>
       <li><a href="/examples/">Examples</a></li>
       <li><a href="/examples/roots/">Rootfinding</a></li>
       <li class="active">Complex roots near the real axis</li>
    </ol>

    <div class="page-header">
 
        <h1>Complex roots near the real axis</h1>
        <h2>Nick Trefethen, 26th October 2011</h2>
    </div>

    <div class="row">

<!--
        <div class="col-md-4" role="navigation"> 
        </div>
-->

        <div class="content">
            <div class="col-md-8" data-spy="scroll" data-target="#sidenav" role="main">
                <p>Here's a wiggly chebfun defined on [0,30]:</p>
<pre class="mcode-input">x = chebfun('x',[0 30]);
f = 3 + sin(x) + sin(pi*x);
LW = 'linewidth';
plot(f,LW,2)</pre>

<p><img src="img/RootsNearAxis_01.png" alt=""></p>
<p>The chebfun has no roots on the interval:</p>
<pre class="mcode-input">roots(f)</pre>

<pre class="mcode-output">ans =
   Empty matrix: 0-by-1
</pre>

<p>It has some roots near the interval in the complex plane, however, and the chebfun will have some accuracy for these complex values. We can get an idea of the relevant region with chebellipseplot, which plots the "Chebfun ellipse" for f:</p>
<pre class="mcode-input">clf, chebellipseplot(f,LW,2), grid on
xlim([-5 35]), axis equal
hold on, plot(x,0*x,'k',LW,1.5)</pre>

<p><img src="img/RootsNearAxis_02.png" alt=""></p>
<p>The number of digits of accuracy of the chebfun can be expected to reduce smoothly from 15 or so along the interval down to 0 on the ellipse.</p>
<p>This provides an easy way to calculate roots of functions in the complex plane near the interval of definition, using ROOTS with the flag 'complex':</p>
<pre class="mcode-input">r = roots(f,'complex'); plot(r,'.r','markersize',18)</pre>

<p><img src="img/RootsNearAxis_03.png" alt=""></p>
<p>Notice that the number of roots is is less than the polynomial degree of the chebfun:</p>
<pre class="mcode-input">number_of_roots = length(r)
degree = length(f)-1</pre>

<pre class="mcode-output">number_of_roots =
    32
degree =
    83
</pre>

<p>That's because there are quite a few additional roots of the chebfun that have nothing to do with roots of the underlying function.  We can see them with the flag 'all':</p>
<pre class="mcode-input">plot(roots(f,'all'),'or'), axis auto, axis equal</pre>

<p><img src="img/RootsNearAxis_04.png" alt=""></p>
<p>For more details about computations like these, see Section 3.6 of the Chebfun Guide, and for more on the mathematics, see Chapters 8 and 18 of [1].</p>
<p>Reference:</p>
<p>[1] L. N. Trefethen, Approximation Theory and Approximation Practice, SIAM, 2013.</p>
            </div>
        </div>

    </div>
    

    <div class="footer">
        <div style="margin: 5px">
        </div>
        <p>Website powered by <a href="http://urubu.jandecaluwe.com">Urubu</a>.</p>
    </div>


</div> 


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/js/config.js"></script>

  </body>
</html>