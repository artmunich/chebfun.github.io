<!DOCTYPE html>
<html>
  <head>
    <title>Eigenvalue level repulsion &raquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <!-- Bootstrap -->
    <link href="/css/bootstrap-custom.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/site.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/syntax.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/flexslider.css" rel="stylesheet"><!--  media="screen" -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<!-- ********* BEGIN GOOGLE ANALYTICS *********** -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4297200-9");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- ********* END GOOGLE ANALYTICS *********** -->  </head>

  <body>

    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!-- <a class="navbar-brand" href="/">Chebfun</a> -->
          <a id="logo" href="/"><img src='/images/logo.png' /></a>
        </div>
        <div class="navbar-collapse collapse">

          <!--<ul class="nav navbar-nav navbar-left"></ul>-->

          <ul class="nav navbar-nav navbar-right">
            <li><a href="/about/">About</a></li>
            <li><a href="/download/">Download</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li class="active"><a href="/examples/">Examples</a></li>
            <li><a href="/develop/">Develop</a></li>
            <li><a href="/citing/">Citing</a></li>
            <li><a href="/support/">Support</a></li>
          </ul>

        </div><!--/.nav-collapse -->
      </div>
    </div>


<div class="container">

    <ol class="breadcrumb">
       <li><a href="/">Home</a></li>
       <li><a href="/examples/">Examples</a></li>
       <li><a href="/examples/linalg/">Linear algebra</a></li>
       <li class="active">Eigenvalue level repulsion</li>
    </ol>

    <div class="page-header">
 
        <h1>Eigenvalue level repulsion</h1>
        <h2>Nick Trefethen, October 2010</h2>
    </div>

    <div class="row">

<!--
        <div class="col-md-4" role="navigation"> 
        </div>
-->

        <div class="content">
            <div class="col-md-8" data-spy="scroll" data-target="#sidenav" role="main">
                <p>If A and B are real symmetric matrices of dimension n, then each will have n real eigenvalues, counted with multiplicity. If you morph one matrix into the other by the formula</p>
<p>A(t) = (1-t)A + tB ,</p>
<p>then as t increases from 0 to 1, the eigenvalues will change continuously from those of A to those of B.</p>
<p>It is possible for A(t) to have multiple eigenvalues for some t (i.e. fewer than n distinct eigenvalues), but generically, this will not happen.  That is to say, if A and B are selected at random in a reasonable sense from the set of all real symmetric matrices of dimension n, the probability will be zero that there will be any value of t for which A(t) has a multiple eigenvalue. This phenomenon of ''level repulsion'' or ''eigenvalue avoided crossings'' goes back to von Neumann and Wigner and is well known to physicists. It is illustrated on the cover of Peter Lax's textbook Linear Algebra [1].</p>
<p>We can illustrate the effect with Chebfun.  First we pick a pair of random matrices A and B:</p>
<pre class="mcode-input">n = 10;
randn('seed',1);
A = randn(n); A = A+A'; B = randn(n); B = B+B';</pre>

<pre class="mcode-output">Warning: Using 'seed' to set RANDN's internal state causes RAND, RANDI, and
RANDN to use legacy random number generators.  This syntax will be removed in a
future release.  See &lt;a href="matlab:helpview([docroot
'\techdoc\math\math.map'],'update_random_number_generator')"&gt;Updating Your
Random Number Generator Syntax&lt;/a&gt; to use RNG to replace the old syntax. 
</pre>

<p>We would now like to get our hands on the n functions of t representing the n eigenvalues of A(t).  In Chebfun, a convenient format for this result will be a quasimatrix with n columns.  The first column will contain a chebfun for the lowest eigenvalue of A(t) as a function of t, the 2nd column for the 2nd eigenvalue, and so on.</p>
<p>We can construct this quasimatrix as follows.  (The ''splitting off'' command has no effect, since splitting off is the default, but is included to show where one would put ''splitting on'' to handle a problem with curves actually crossing or coming very close.)</p>
<pre class="mcode-input">ek = @(e,k) e(k);            % returns kth element of the vector e
eigA = @(A) sort(eig(A));    % returns sorted eigenvalues of the matrix A
eigk = @(A,k) ek(eigA(A),k); % returns kth eigenvalue of the matrix A
d = [0 1];
t = chebfun('t',d);
E = chebfun; tic
for k = 1:n
   E(:,k) = chebfun(@(t) eigk((1-t)*A+t*B,k),d,'splitting','off','vectorize');
end
FS = 'fontsize'; LW = 'linewidth'; MS = 'markersize';
figure, plot(E,LW,1.6), grid on
title('Eigenvalues of (1-t)A + tB',FS,16);
xlabel('t',FS,12), toc</pre>

<pre class="mcode-output">Elapsed time is 1.517063 seconds.
</pre>

<p><img src="img/LevelRepulsion_01.png" alt=""></p>
<p>The 5th and 6th curves have a very close near-crossing.  We can find it like this:</p>
<pre class="mcode-input">E5 = E(:,5); E6 = E(:,6);
[minval,minpos] = min(E6-E5)</pre>

<pre class="mcode-output">minval =
   0.019588198983148
minpos =
   0.866611938053627
</pre>

<p>Let's zoom in and mark the minimal gap in red:</p>
<pre class="mcode-input">axis([minpos-.05 minpos+.05 E5(minpos)-.4 E5(minpos)+.4])
title(['Zooming in: the gap width is ' num2str(minval)],FS,16)
hold on, plot(minpos,E5(minpos),'.r',MS,18)
hold on, plot(minpos,E6(minpos),'.r',MS,18)</pre>

<p><img src="img/LevelRepulsion_02.png" alt=""></p>
<p>References:</p>
<p>[1] P. Lax, Linear Algebra, Wiley, 1996.</p>
<p>[2] J. von Neumann and E. Wigner, Ueber das Verhalten von Eigenwerten bei adiabatischen Prozessen, Phys. Zeit. 30 (1929), 467-470.</p>
            </div>
        </div>

    </div>
    

    <div class="footer">
        <div style="margin: 5px">
        </div>
        <p>Website powered by <a href="http://urubu.jandecaluwe.com">Urubu</a>.</p>
    </div>


</div> 


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/js/config.js"></script>
    <script type="text/javascript" src="/js/jquery.flexslider-min.js"></script>

  </body>
</html>