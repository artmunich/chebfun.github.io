---
title: "Frequencies of a drum"
layout: example
authordate: "Toby Driscoll, November 2010"
meta: "(Chebfun example ode-eig/Drum.m) [Tags: #eigenvalues, #rootfinding]"
---

<pre class="mcode-input">function Drum</pre>The axisymmetric harmonic vibrations of a circular drum can be described by the ODE

$$  u''(r) + r^{-1} u'(r) = -\omega^2 u(r),~~   u'(0)=1, u(1)=0, $$

where $r$ is the radial coordinate and $\omega$ is the frequency of vibration. Only discrete positive values of $\omega$ are possible, corresponding to the eigenvalues of the differential equation.

We multiply the ODE through by $r$ to avoid a potential division by zero. This creates a generalized problem in the form $Au = \lambda Bu$.

<pre class="mcode-input">r = chebfun('r',[0,1]);
A = chebop(0,1);
A.op = @(r,u) r.*diff(u,2) + diff(u);
A.lbc = 'neumann'; A.rbc = 'dirichlet';
B = chebop(0,1);
B.op = @(r,u) r.*u;</pre>Then we find the eigenvalues with `eigs`. It turns out that the $\omega$ values are also zeros of the Bessel function $J_0$, which gives a way to valudate the results.

<pre class="mcode-input">[V,D] = eigs(A,B);
[omega,ii] = sort(sqrt(-diag(D))); omega
V = [V{:,ii'}]
err = omega - sort(roots( besselj(0,chebfun('r',[0 20])) ))</pre><pre class="mcode-output">omega =
   2.404825557945834
   5.520078110505139
   8.653727912947318
  11.791534439019804
  14.930917708488476
  18.071063967909421
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       29       1.5 -4.4e-13 
Epslevel = 6.698335e-13.  Vscale = 1.453294e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       29        -2 -5.6e-13 
Epslevel = 6.698335e-13.  Vscale = 1.991007e+00.
   chebfun column3 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       29      -2.4 -2.7e-13 
Epslevel = 6.698335e-13.  Vscale = 2.375259e+00.
   chebfun column4 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       29       2.7    6e-13 
Epslevel = 6.698335e-13.  Vscale = 2.688190e+00.
   chebfun column5 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       29         3  5.8e-13 
Epslevel = 6.698335e-13.  Vscale = 2.957848e+00.
   chebfun column6 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       29      -3.2  9.7e-14 
Epslevel = 6.698335e-13.  Vscale = 3.197755e+00.
err =
   1.0e-09 *
   0.250053311390275
   0.218834728116235
   0.036301628369984
   0.005526246127374
   0.000692779167366
  -0.001502797886133
</pre>We also get the eigenfunctions, which gives a way to visualize deflections of the drums for pure frequencies.

<pre class="mcode-input">V = V*diag(sign(V(0,:)));  % ensure V(0,k) &gt; 0
[rr,tt] = meshgrid(linspace(0,1,40),linspace(0,2*pi,60));
for k = 1:4,
  subplot(2,2,k), mesh(rr.*cos(tt),rr.*sin(tt),repmat(V(rr(1,:),k),60,1))
  zlim([-1 3]),caxis([-3 3]), view(-33,20), axis off
end</pre><img src="img/Drum_01.png" class="figure" alt="">

If the drum instead has a variable density given by $\rho(r)$, the right- hand side of the original ODE becomes $-\omega^2\rho u$. In general, the connection to Bessel functions is broken, but we will not miss a beat using `eigs`.

Constant density gives $\omega_2/\omega_1 = 2.2954$. Let's design a density so that $\omega_2/\omega_1 = 2$, a perfect octave. We will search among density functions of the form

$$ \rho(r) = 1 - a\sin(\pi r). $$

Here is a function that returns the ratio for any $a$.

<pre class="mcode-input">function ratio = evratio(a)
  rho = 1 - a*sin(pi*r);
  B.op = @(r,u) r.*rho.*u;
  [V,D] = eigs(A,B,2,0);
  [omega,ii] = sort(sqrt(-diag(D)));
  V = [V{:,ii'}]
  ratio = omega(2)/omega(1);
end</pre>Now, we create a chebfun to hit the target.

<pre class="mcode-input">ratfun = chebfun(@evratio,[0.5,1],'vectorize','eps',1e-11);
astar = find(ratfun==2)
clf, plot(ratfun), title('Eigenvalue ratio'), xlabel('a')
set(gca,'xtick',[0.5,astar,1],'ytick',[2],'xgrid','on','ygrid','on')</pre><pre class="mcode-output">V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5    1e-13 
Epslevel = 9.103587e-14.  Vscale = 1.509591e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.5e-13 
Epslevel = 9.103587e-14.  Vscale = 2.064601e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26       1.7 -2.1e-14 
Epslevel = 3.444432e-13.  Vscale = 1.741150e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26      -1.9 -4.7e-13 
Epslevel = 3.444432e-13.  Vscale = 1.881931e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5  9.8e-14 
Epslevel = 6.715385e-14.  Vscale = 1.508664e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.2e-13 
Epslevel = 6.715385e-14.  Vscale = 2.063855e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5  4.1e-15 
Epslevel = 6.685595e-14.  Vscale = 1.509555e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.5e-13 
Epslevel = 6.685595e-14.  Vscale = 2.064572e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21       1.5  1.2e-13 
Epslevel = 1.206465e-13.  Vscale = 1.512262e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21      -2.1  3.8e-13 
Epslevel = 1.206465e-13.  Vscale = 2.066669e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21       1.5  1.5e-13 
Epslevel = 2.159636e-13.  Vscale = 1.516886e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21      -2.1  2.3e-13 
Epslevel = 2.159636e-13.  Vscale = 2.069970e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5    2e-13 
Epslevel = 3.757651e-13.  Vscale = 1.523596e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  8.4e-13 
Epslevel = 3.757651e-13.  Vscale = 2.074144e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5 -6.4e-13 
Epslevel = 7.324769e-13.  Vscale = 1.532631e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.6e-12 
Epslevel = 7.324769e-13.  Vscale = 2.078636e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.5   -8e-13 
Epslevel = 7.464434e-13.  Vscale = 1.544292e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  2.9e-13 
Epslevel = 7.464434e-13.  Vscale = 2.082576e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.6 -9.3e-13 
Epslevel = 2.559941e-12.  Vscale = 1.558921e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1    1e-13 
Epslevel = 2.559941e-12.  Vscale = 2.084659e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.6 -8.1e-13 
Epslevel = 2.466567e-12.  Vscale = 1.576849e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  7.4e-13 
Epslevel = 2.466567e-12.  Vscale = 2.083033e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.6 -7.8e-15 
Epslevel = 7.733801e-12.  Vscale = 1.598296e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.6e-11 
Epslevel = 7.733801e-12.  Vscale = 2.075285e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.6  2.4e-12 
Epslevel = 6.735988e-12.  Vscale = 1.623186e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  1.8e-12 
Epslevel = 6.735988e-12.  Vscale = 2.058709e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.7  7.6e-15 
Epslevel = 1.132800e-13.  Vscale = 1.650882e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25        -2  8.3e-14 
Epslevel = 1.132800e-13.  Vscale = 2.031148e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.7  4.4e-13 
Epslevel = 4.256815e-13.  Vscale = 1.679902e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25        -2  1.7e-13 
Epslevel = 4.256815e-13.  Vscale = 1.992562e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.7  3.4e-15 
Epslevel = 3.699533e-13.  Vscale = 1.707773e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25      -1.9  3.3e-13 
Epslevel = 3.699533e-13.  Vscale = 1.946821e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26       1.7   -1e-14 
Epslevel = 2.955474e-13.  Vscale = 1.731259e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26      -1.9 -4.2e-13 
Epslevel = 2.955474e-13.  Vscale = 1.902234e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.7  1.2e-12 
Epslevel = 7.147840e-13.  Vscale = 1.747034e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25      -1.9  7.2e-13 
Epslevel = 7.147840e-13.  Vscale = 1.869451e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.8  1.3e-12 
Epslevel = 7.498983e-13.  Vscale = 1.752601e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25      -1.9    2e-12 
Epslevel = 7.498983e-13.  Vscale = 1.857376e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5    1e-13 
Epslevel = 7.169543e-14.  Vscale = 1.508886e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.4e-13 
Epslevel = 7.169543e-14.  Vscale = 2.064035e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5 -2.3e-15 
Epslevel = 7.950215e-14.  Vscale = 1.510677e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.9e-13 
Epslevel = 7.950215e-14.  Vscale = 2.065456e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21       1.5  1.3e-13 
Epslevel = 1.646243e-13.  Vscale = 1.514325e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21      -2.1  3.2e-13 
Epslevel = 1.646243e-13.  Vscale = 2.068185e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21       1.5  1.8e-13 
Epslevel = 2.929852e-13.  Vscale = 1.519967e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       21      -2.1  8.2e-14 
Epslevel = 2.929852e-13.  Vscale = 2.071976e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.5  2.2e-13 
Epslevel = 2.723684e-13.  Vscale = 1.527806e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  1.5e-13 
Epslevel = 2.723684e-13.  Vscale = 2.076396e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5 -7.2e-13 
Epslevel = 1.018269e-12.  Vscale = 1.538113e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  2.2e-12 
Epslevel = 1.018269e-12.  Vscale = 2.080745e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.6 -8.8e-13 
Epslevel = 1.045737e-12.  Vscale = 1.551214e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  3.5e-13 
Epslevel = 1.045737e-12.  Vscale = 2.083952e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.6 -9.2e-13 
Epslevel = 1.881405e-12.  Vscale = 1.567454e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  5.7e-13 
Epslevel = 1.881405e-12.  Vscale = 2.084448e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.6 -5.4e-13 
Epslevel = 3.261084e-12.  Vscale = 1.587128e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  9.3e-13 
Epslevel = 3.261084e-12.  Vscale = 2.080092e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       24       1.6  8.7e-14 
Epslevel = 9.197375e-14.  Vscale = 1.610334e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       24      -2.1 -1.6e-13 
Epslevel = 9.197375e-14.  Vscale = 2.068263e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       24       1.6  5.8e-15 
Epslevel = 7.111080e-14.  Vscale = 1.636753e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       24        -2  1.5e-13 
Epslevel = 7.111080e-14.  Vscale = 2.046377e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.7  3.6e-13 
Epslevel = 4.089257e-13.  Vscale = 1.665358e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25        -2  8.9e-14 
Epslevel = 4.089257e-13.  Vscale = 2.013100e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.7  5.6e-13 
Epslevel = 6.479856e-13.  Vscale = 1.694171e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25        -2  2.4e-13 
Epslevel = 6.479856e-13.  Vscale = 1.970160e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.7  8.3e-13 
Epslevel = 1.251876e-12.  Vscale = 1.720281e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25      -1.9  2.8e-12 
Epslevel = 1.251876e-12.  Vscale = 1.923729e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26       1.7 -1.6e-14 
Epslevel = 3.519931e-13.  Vscale = 1.740296e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26      -1.9 -4.7e-13 
Epslevel = 3.519931e-13.  Vscale = 1.883718e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.8  1.2e-12 
Epslevel = 7.196003e-13.  Vscale = 1.751194e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25      -1.9  2.1e-12 
Epslevel = 7.196003e-13.  Vscale = 1.860451e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5  9.9e-14 
Epslevel = 6.594971e-14.  Vscale = 1.508664e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.2e-13 
Epslevel = 6.594971e-14.  Vscale = 2.063855e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26       1.8 -7.5e-15 
Epslevel = 4.410970e-13.  Vscale = 1.751777e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       26      -1.9 -5.3e-13 
Epslevel = 4.410970e-13.  Vscale = 1.859179e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.8  1.3e-12 
Epslevel = 7.598353e-13.  Vscale = 1.752601e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25      -1.9    2e-12 
Epslevel = 7.598353e-13.  Vscale = 1.857376e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22       1.5  9.8e-14 
Epslevel = 6.715385e-14.  Vscale = 1.508664e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       22      -2.1  1.2e-13 
Epslevel = 6.715385e-14.  Vscale = 2.063855e+00.
V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25       1.8  1.3e-12 
Epslevel = 7.498983e-13.  Vscale = 1.752601e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       25      -1.9    2e-12 
Epslevel = 7.498983e-13.  Vscale = 1.857376e+00.
astar =
   0.812158808550400
</pre><img src="img/Drum_02.png" class="figure" alt="">

We compute the ratio at `astar` to verify the answer, and plot the eigenfunctions.

<pre class="mcode-input">residual = evratio(astar) - 2
subplot(1,2,1), surfl(rr.*cos(tt),rr.*sin(tt),repmat(-V(rr(1,:),1),60,1))
shading interp, lighting phong, title('First mode')
subplot(1,2,2), surfl(rr.*cos(tt),rr.*sin(tt),repmat(-V(rr(1,:),2),60,1))
shading interp, lighting phong, title('Second mode')
colormap copper</pre><pre class="mcode-output">V =
   chebfun column1 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23       1.6  4.4e-13 
Epslevel = 4.845570e-12.  Vscale = 1.604926e+00.
   chebfun column2 (1 smooth piece)
       interval       length   endpoint values  
[       0,       1]       23      -2.1  1.3e-12 
Epslevel = 4.845570e-12.  Vscale = 2.071651e+00.
residual =
    -3.333999742949345e-12
</pre><img src="img/Drum_03.png" class="figure" alt="">

<pre class="mcode-input">end</pre>