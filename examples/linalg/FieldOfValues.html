<!DOCTYPE html>
<html>
  <head>
    <title>Field of values and numerical abscissa &raquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="shortcut icon" href="favicon.ico" /> 

    <!-- Bootstrap -->
    <link href="/_build/css/bootstrap.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/_build/css/normalize.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/_build/css/chebsite.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/_build/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/_build/css/flexslider.css" rel="stylesheet"><!--  media="screen" -->

    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic' rel='stylesheet' type='text/css'>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-4297200-10', 'chebfun.github.io');
  ga('send', 'pageview');
</script>  </head>
  <body>
    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container nav">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
          <a id="logo" href="/_build/"><img src='/_build/images/logo.png' /></a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/_build/about">About</a></li>
            <li><a href="/_build/news">News</a></li>
            <li><a href="/_build/download">Download</a></li>
            <li><a href="/_build/docs">Docs</a></li>
            <li><a href="/_build/examples">Examples</a></li>
            <li><a href="/_build/support">Support</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
<div class="page-wrapper">

    <div class='page-header'>
<h1>Field of values and numerical abscissa</h1>
<h2>Nick Trefethen, November 2010<span><a href='/_build/examples/linalg/FieldOfValues.m'>download</a><span class='sep-sm'>&middot;</span><a href='//github.com/chebfun/examples/blob/master/linalg/FieldOfValues.m'>view on Github</a></span></h2>
</div>

    <div class="container">
<div class="row main">
<div id='content' class="col-sm-12 example" role="main">
<p>If A is a matrix, the field of values F(A) is the nonempty bounded convex set in the complex plane consisting of all the Rayleigh quotients of A, that is, all the numbers q'Aq, where q is a unit vector and q' is its conjugate transpose.</p>
<p>The standard method for computing the field of values numerically is an algorithm due to C. R. Johnson in 1978 based on finding the maximum and minimum eigenvalues of (A+A')/2, then "rotating" this computation around in the complex plane [1]. This algorithm is implemented in the Chebfun command FOV, which is listed at the end of this Example.</p>
<p>Generically the boundary of the field of values is smooth, but it is not always smooth.  Chebfun's 'splitting' feature enables FOV to compute this boundary in either situation, smooth or not.</p>
<p>For example, here are the eigenvalues and field of values of a random matrix of dimension 20. This is a case where the boundary is smooth.</p>
<pre class="mcode-input">rng(1), A = randn(20);
LW = 'linewidth'; lw = 1.6; MS = 'markersize'; ms = 18;
FA = fov(A);
figure, plot(FA,LW,lw), axis equal, grid on
ax = axis; axis(1.1*ax)
hold on, plot(eig(A),'.k',MS,ms)</pre>

<p><img src="img/FieldOfValues_01.png" class="figure" alt=""></p>
<p>The numerical abscissa of A is the maximum real part of its field of values:</p>
<pre class="mcode-input">[alpha,maxtheta] = max(real(FA))</pre>

<pre class="mcode-output">alpha =
   5.556701165271448
maxtheta =
     0
</pre>

<p>Here we add it to the plot as a red dot:</p>
<pre class="mcode-input">plot(real(FA(maxtheta)),imag(FA(maxtheta)),'.r',MS,24)</pre>

<p><img src="img/FieldOfValues_02.png" class="figure" alt=""></p>
<p>You can also find the numerical abscissa without Chebfun:</p>
<pre class="mcode-input">alpha = max(eig((A+A')/2))</pre>

<pre class="mcode-output">alpha =
   5.556701165271409
</pre>

<p>Now let's consider a matrix B defined as a diagonal matrix with the same eigenvalues as A. In this case the boundary of the field of values is a polygon:</p>
<pre class="mcode-input">B = diag(eig(A));
FB = fov(B);
hold off, plot(real(FB),imag(FB),'b',LW,lw,'jumpline',{'b',LW,lw})
hold on, plot(eig(B),'.k',MS,ms), axis(1.1*ax), axis equal, grid on
[alpha,maxtheta] = max(real(FB));
plot(real(FB(maxtheta)),imag(FB(maxtheta)),'.r',MS,24)</pre>

<pre class="mcode-output">Error using cellfun
Non-scalar in Uniform output, at index 7, output 1.
Set 'UniformOutput' to false.
Error in chebfun/plot (line 144)
jumpLineSet = any(cellfun(@(v) strcmpi(v, 'JumpLine'), varargin));
Error in FieldOfValues (line 60)
hold off, plot(real(FB),imag(FB),'b',LW,lw,'jumpline',{'b',LW,lw})</pre>

<p>Since the field of values is not smooth, its boundary is a chebfun with several pieces:</p>
<pre class="mcode-input">FB</pre>

<p>Finally, here's an example where the boundary of the field of values mixes smooth curves with straight segments:</p>
<pre class="mcode-input">C = [0 3 0 0; -3 0 0 0; 0 0 0 3; 0 0 1 1]
FC = fov(C);
hold off, plot(real(FC),imag(FC),'b',LW,lw,'jumpline',{'b',LW,lw})
axis(4*[-1 1 -1 1]), axis square, grid on
hold on, plot(eig(C),'.k',MS,ms)</pre>

<p>Here is a listing of FOV. Note that the numerical computations are carried out in just about 10 lines of code.</p>
<pre class="mcode-input">type fov</pre>

<h3 id="references">References</h3>
<ol>
<li>
<p>C. R. Johnson, Numerical determination of the field of values of a    general complex matrix, <em>SIAM Journal on Numerical    Analysis</em>, 15 (1978), 595-602.</p>
</li>
<li>
<p>L. N. Trefethen and M. Embree, <em>Spectra and Pseudospectra: The Behavior of    Nonnormal Matrices and Operators</em>, Princeton U. Press, 2005, chapter 17 on    Numerical range, abscissa, and radius.</p>
</li>
</ol></div>
        </div>
    </div>
</div>
    <div class="footer">
        <p>&copy; Copyright 2014 the University of Oxford and the Chebfun Developers.</p>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="/_build/js/bootstrap.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/_build/js/config.js"></script>
    <script type="text/javascript" src="/_build/js/jquery.flexslider-min.js"></script>
  </body>
</html>