<!DOCTYPE html>
<html>
  <head>
    <title>Undergraduate multivariable calculus &raquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="shortcut icon" href="favicon.ico" /> 

    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/normalize.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/chebsite.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/flexslider.css" rel="stylesheet"><!--  media="screen" -->

    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic' rel='stylesheet' type='text/css'>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-4297200-10', 'chebfun.github.io');
  ga('send', 'pageview');
</script>  </head>
  <body>
    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container nav">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
          <a id="logo" href="/"><img src='/images/logo.png' /></a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/about">About</a></li>
            <li><a href="/news">News</a></li>
            <li><a href="/download">Download</a></li>
            <li><a href="/docs">Docs</a></li>
            <li><a href="/examples">Examples</a></li>
            <li><a href="/support">Support</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
<div class="page-wrapper">

    <div class='page-header'>
<h1>Undergraduate multivariable calculus</h1>
<h2>Alex Townsend, March 2013<span><a href='/examples/veccalc/UndergraduateCalculus.m'>download</a><span class='sep-sm'>&middot;</span><a href='//github.com/chebfun/examples/blob/master/veccalc/UndergraduateCalculus.m'>view on Github</a></span></h2>
</div>

    <div class="container">
<div class="row main">
<div id='content' class="col-sm-12 example" role="main">
<p>First year maths students at Oxford University take a course called Multivariable Calculus.  In this course they are asked to calculate things with pen and paper, and they come to realise how cumbersome it can be to work out multidimensional integrals by hand. In this example we use Chebfun2 to explore a few of their questions but, in general, we do <em>not</em> give the answers.</p>
<h3 id="integration-of-a-scalar-valued-function">Integration of a scalar-valued function</h3>
<p>The first question on the first problem sheet is to compute the value of</p>
<p>$$ \int_0^a \int_0^b xy\cos(x^2y+y) dxdy, $$</p>
<p>and we can compute this integral if we set, for instance, $a=1$ and $b=5$. Here is a plot of the integrand:</p>
<pre class="mcode-input">a = 1; b = 5;
integrand = chebfun2(@(x,y) x.*y.*cos(x.^2.*y+y),[0 b 0 a]);
plot(integrand), zlim([-10 10])</pre>

<p><img src="img/UndergraduateCalculus_01.png" class="figure" alt=""></p>
<p>The students calculate the answer in closed form, but Chebfun2 can compute the integral numerically:</p>
<pre class="mcode-input">ans = integral(integrand)            % computed quantity
exact = -sin(1/2)^2 + sin(13)^2/26   % student's closed form</pre>

<pre class="mcode-output">ans =
  -0.223058834033789
exact =
  -0.223058834033789
</pre>

<h3 id="computing-the-area-enclosed-by-a-curve">Computing the area enclosed by a curve</h3>
<p>The students are also asked to compute several areas enclosed by curves. There is nothing 2D about this problem and we can just use ordinary Chebfun (see [1]).</p>
<p>Show that the area bounded by the curve $r = a(1+\cos(\theta))$, $0\leq \theta &lt; 2\pi$ is exactly $3/2\pi a^2$. We answer this question with the choice of $a = 2$. Here is a sketch of the curve:</p>
<pre class="mcode-input">a = 2;
c = chebfun(@(theta) a*(1+cos(theta)).*exp(1i*theta),[0 2*pi]);
plot(c), axis equal
FS = 'fontsize';
title('Sketch of curve',FS,12)</pre>

<p><img src="img/UndergraduateCalculus_02.png" class="figure" alt=""></p>
<p>Here is the computed area bounded by the curve and the exact area:</p>
<pre class="mcode-input">ans = integral(real(c).*diff(imag(c)))  % area bounded by curve
exact = 1.5*pi*a^2</pre>

<pre class="mcode-output">ans =
  18.849555921538741
exact =
  18.849555921538759
</pre>

<p>The expression for the area enclosed by the curve can be found by Green's theorem, though the first year students calculate the area by a change of variables.</p>
<h3 id="a-change-of-variables">A change of variables</h3>
<p>First year students are expected to change routinely from Cartesian to polar, cylindrical and spherical coordinates, and for less standard variable transforms a hint is usually given in the question. In one question the students are asked to evaluate</p>
<p>$$ \int_D (x^2+y^2) dxdy $$</p>
<p>over the finite region $D$ in the positive quadrant bounded by the curves</p>
<p>$$ x^2-y^2=\pm 1, \qquad xy=1/2.  $$</p>
<p>In general, an Oxford student's drawing skills are not up to their mathematical ability, but Chebfun2 can draw an accurate diagram! Here is the region $D$:</p>
<pre class="mcode-input">d = [0 5 0 5];
u = chebfun2(@(x,y) x.^2-y.^2,d);
v = chebfun2(@(x,y) x.*y-1/2,d);
c1 = roots(u-1); c2 = roots(u+1); c3 = roots(v-1/2);
plot(c1), hold on, plot(c2), plot(c3,'k'), axis square
title('Region of integration',FS,12), hold off
text(.5,.5,'D',FS,12)</pre>

<p><img src="img/UndergraduateCalculus_03.png" class="figure" alt=""></p>
<p>The question tells the students to change to the variables $u=x^2-y^2$ and $v=xy$, which can be done quite straightforwardly. Most students are able to make this simple, but non-standard change of variables, and calculate the correct answer.  We will not reveal the answer here.</p>
<h3 id="line-integrals-with-vector-valued-functions">Line integrals with vector-valued functions</h3>
<p>Simple line integrals start appearing around week 4 of the course, and students find the notation confusing at first, but are still very impressive human calculators. Almost every student is able to solve the following problem: calculate the integral of</p>
<p>$$ \int_C \left(y^2,-x^2\right)\cdot d\mathbf{r}, $$</p>
<p>where $C$ is the portion of the ellipse $x^2/4+y^2=1$ that lies in the positive quadrant.</p>
<p>In this question it is easy to parameterise the curve by $x=2\cos(t)$ and $y=\sin(t)$, and we can then use the integral command in chebfun2v to compute the result:</p>
<pre class="mcode-input">d = 3*[-1 1 -1 1];
C1 = chebfun(@(t) 2*cos(t) + 1i*sin(t),[0 pi/2]);
F = chebfun2v(@(x,y)y.^2,@(x,y) -x.^2,d);
integral(F,C1)</pre>

<pre class="mcode-output">ans =
  -3.999999999999998
</pre>

<p>Here is the plot of the parameterised curve, and the vector field of $F$:</p>
<pre class="mcode-input">plot(C1,'linewidth',2), axis(d), hold on
quiver(F), hold off</pre>

<p><img src="img/UndergraduateCalculus_04.png" class="figure" alt=""></p>
<p>The diagram shows that $F$ always points in a direction approximately opposite to the direction of the curve's tangent vector and hence, the result is negative --- a first order sanity check.</p>
<p>For more general curves a parameterisation may be very difficult, or impossible, to find. Instead, in this example, we can compute a numerical parameterisation and then use the integral command in chebfun2v.</p>
<pre class="mcode-input">level = chebfun2(@(x,y) x.^2/4 + y.^2-1,[0 3 0 3]);
C2 = roots(level);
integral(F,C2)</pre>

<pre class="mcode-output">ans =
  -3.970176744730233
</pre>

<p>We did not obtain machine precision because the curve is approximated to only 4-5 digits due to several limitations of the algorithm for computing the zero contours of a function.</p>
<h3 id="line-integrals-with-scalar-valued-functions">Line integrals with scalar-valued functions</h3>
<p>The students also integrate scalar-valued functions over curves. For example, what is the integral of a $\cos(xy/10)$ over the "flower" curve?</p>
<pre class="mcode-input">t = chebfun('t',[0,2*pi]);
b = 1; m = 7; a = (m-1)*b;
x = (a+b)*cos(t) - b*cos((a+b)/b*t);
y = (a+b)*sin(t) - b*sin((a+b)/b*t);
c = x + 1i*y;                         % flower curve

f = chebfun2(@(x,y) cos(x.*y/10),[-8 8 -10 10]); % integrand

contour(f), axis equal tight, hold on
plot(c,'k'), hold off</pre>

<p><img src="img/UndergraduateCalculus_05.png" class="figure" alt=""></p>
<p>Here is the computed integral:</p>
<pre class="mcode-input">integral(f,c)</pre>

<pre class="mcode-output">ans =
  -7.429899228439556
</pre>

<h3 id="vector-calculus-identity">Vector calculus identity</h3>
<p>In the second half of the course the students begin to study the vector calculus operators: div, grad, and curl. They are asked to prove many vector calculus identities, one of which is</p>
<p>$$ \nabla\cdot(F\wedge G) = G\cdot(\nabla
\wedge F) - F\cdot(\nabla \wedge G). $$</p>
<p>We can verify this identity for a chosen $F$ and $G$:</p>
<pre class="mcode-input">F = chebfun2v(@(x,y) y,@(x,y) x.^2,@(x,y) x);
G = chebfun2v(@(x,y) cos(2*x),@(x,y) x,@(x,y) x+y);
subplot(1,2,1), quiver3(F,'numpts',5)
subplot(1,2,2), quiver3(G,'r','numpts',5)</pre>

<p><img src="img/UndergraduateCalculus_06.png" class="figure" alt=""></p>
<p>The vector calculus identity holds with a small error. If it were done by hand, <code>LHS</code> and <code>RHS</code> would be exactly equal.</p>
<pre class="mcode-input">LHS = divergence(cross(F,G));
RHS = (dot(G,curl(F)) - dot(F,curl(G)));
norm(LHS-RHS)</pre>

<pre class="mcode-output">ans =
     5.472336319999712e-14
</pre>

<h3 id="further-comments">Further comments</h3>
<p>The multivariable course has another two weeks to go, out of a total of only eight weeks. This example will be updated if Chebfun2 is able to explore any more topics from the multivariate calculus course.</p>
<p>This is an adapted version of a document that I presented to the first year students.  I believe they had not appreciated that vector calculus could be done with a computer, and they were amazed at how visual vector calculus can be.  The students are exceptionally bright, extremely enthusiastic and know MATLAB.</p>
<h3 id="references">References</h3>
<ol>
<li>Chebfun Example <a href="../geom/Area.html">geom/Area</a></li>
</ol></div>
        </div>
    </div>
</div>
    <div class="footer">
        <p>&copy; Copyright 2014 the University of Oxford and the Chebfun Developers.</p>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/js/config.js"></script>
    <script type="text/javascript" src="/js/jquery.flexslider-min.js"></script>
  </body>
  <!-- Compiled on Friday, 20 June 2014 at 01:31. -->
</html>