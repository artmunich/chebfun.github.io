<!DOCTYPE html>
<html>
  <head>
    <title>Extrema of a complicated function &raquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <!-- Bootstrap -->
    <link href="/css/bootstrap-custom.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/site.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/syntax.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/flexslider.css" rel="stylesheet"><!--  media="screen" -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<!-- ********* BEGIN GOOGLE ANALYTICS *********** -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4297200-9");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- ********* END GOOGLE ANALYTICS *********** -->  </head>

  <body>

    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <!-- <a class="navbar-brand" href="/">Chebfun</a> -->
          <a id="logo" href="/"><img src='/images/logo.png' /></a>
        </div>
        <div class="navbar-collapse collapse">

          <!--<ul class="nav navbar-nav navbar-left"></ul>-->

          <ul class="nav navbar-nav navbar-right">
            <li><a href="/about/">About</a></li>
            <li><a href="/download/">Download</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li class="active"><a href="/examples/">Examples</a></li>
            <li><a href="/develop/">Develop</a></li>
            <li><a href="/citing/">Citing</a></li>
            <li><a href="/support/">Support</a></li>
          </ul>

        </div><!--/.nav-collapse -->
      </div>
    </div>


<div class='jumbotron page-header'>
    <div class='container'>
        <div class="row">
            <div class="col-md-12">
 
                <h1>Extrema of a complicated function</h1>
                <h2>Nick Trefethen, September 2010</h2>
            </div>
        </div>
    </div>
</div>

<div class="container">

    <ol class="breadcrumb">
       <li><a href="/">Home</a></li>
       <li><a href="/examples/">Examples</a></li>
       <li><a href="/examples/opt/">Optimization</a></li>
       <li class="active">Extrema of a complicated function</li>
    </ol>

    <div class="row">

<!--
        <div class="col-md-4" role="navigation"> 
        </div>
-->

        <div class="content example-content">
            <div class="col-md-12" data-spy="scroll" data-target="#sidenav" role="main">
                <p>Here is the function cos(x)*sin(exp(x)) on the interval [0,6]:</p>
<pre class="mcode-input">tic, x = chebfun('x',[0 6]);
f = cos(x).*sin(exp(x));
length(f)
plot(f,'color',[0 .7 0],'numpts',10000)
FS = 'fontsize';
title('A complicated function',FS,14)</pre>

<pre class="mcode-output">ans =
   529
</pre>

<p><img src="img/ExtremeExtrema_01.png" alt=""></p>
<p>Here's its absolute value:</p>
<pre class="mcode-input">g = abs(f);
plot(g,'m','numpts',10000)
title('Absolute value',FS,14)</pre>

<p><img src="img/ExtremeExtrema_02.png" alt=""></p>
<p>Here's the minimum of that function and x/8:</p>
<pre class="mcode-input">h = min(g,x/8);
plot(h,'numpts',10000)
title('Minimum with x/8',FS,14)</pre>

<p><img src="img/ExtremeExtrema_03.png" alt=""></p>
<p>We can find the maximum over the interval [0,5] like this:</p>
<pre class="mcode-input">[maxval,maxpos] = max(h{0,5})
hold on, plot(maxpos,maxval,'.r','markersize',40)
title('Global maximum',FS,14)</pre>

<pre class="mcode-output">maxval =
   0.520496207016738
maxpos =
   4.164759283173292
</pre>

<p><img src="img/ExtremeExtrema_04.png" alt=""></p>
<p>Let's add all the local extrema to the plot:</p>
<pre class="mcode-input">hp = diff(h);
extrema = roots(hp);
plot(extrema,h(extrema),'.k','markersize',6)
title('Local extrema',FS,14)</pre>

<p><img src="img/ExtremeExtrema_05.png" alt=""></p>
<p>These computations showcase the fact that Chebfun optimization is global -- whether in the sense of finding a global extremum, or in the sense of globally finding all the local extrema.</p>
<p>They also showcase the treatment of discontinuities. To find extrema, Chebfun looks for zeros of the derivative. In some cases those are points where the derivative is continuous and passes through zero. In others, like the leftmost black dot in the plot above, they are points where the derivative jumps from positive to negative or vice versa.</p>
<p>Here is the time for this whole sequence of computations:</p>
<pre class="mcode-input">Total_time = toc</pre>

<pre class="mcode-output">Total_time =
  29.540320963999999
</pre>
            </div>
        </div>

    </div>
    

</div> 


    <div class="footer">
        <div style="margin: 5px">
        </div>
        <p>&copy; Copyright 2014 the University of Oxford and the Chebfun Developers.</p>
    </div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/js/config.js"></script>
    <script type="text/javascript" src="/js/jquery.flexslider-min.js"></script>

  </body>
</html>